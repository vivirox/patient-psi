---
import type { Message } from '@/lib/types';
import { IconUser, IconAssistant } from '@/components/ui/icons';
import { cn } from '@/lib/utils';
import Markdown from './Markdown.astro';

interface Props {
  message: Message;
  className?: string;
}

const { message, className } = Astro.props;

const iconMap = {
  user: IconUser,
  assistant: IconAssistant,
  system: IconAssistant
};

const Icon = iconMap[message.role] || IconUser;
---

<div class:list={['group relative mb-4 flex items-start md:mb-6', className]}>
  <div class="flex size-8 shrink-0 select-none items-center justify-center rounded-md border shadow bg-background">
    <Icon class="size-4" />
  </div>
  <div class="ml-4 flex-1 space-y-2 overflow-hidden px-1">
    <div class="prose break-words dark:prose-invert prose-p:leading-relaxed prose-pre:p-0">
      <Markdown content={message.content} />
    </div>
  </div>
</div>
